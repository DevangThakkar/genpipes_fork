<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<smrtpipeSettings>
    <protocol version="2.1.0" id="RS_Resequencing.1" editable="false">
        <param name="name" label="Protocol Name" editable="false">
            <value>RS_Resequencing</value>
            <input type="text"/>
            <rule required="true"/>
        </param>
        <param name="description">
            <value>A general-purpose analysis workflow for whole-genome or targeted resequencing with homozygous SNP and indel calling. Reads are filtered by length and quality, mapped to a provided reference sequence, and consensus and variants are identified versus this reference using the Quiver algorithm.
      </value>
            <textarea></textarea>
        </param>
        <param name="version" hidden="true">
            <value>1</value>
            <input type="text"/>
            <rule type="digits" required="true" min="1.0"/>
        </param>
        <param name="state" hidden="true">
            <value>active</value>
            <input value="active" type="radio"/>
            <input value="inactive" type="radio"/>
        </param>
        <param name="reference" hidden="true">
            <value>REFERENCE</value>
        </param>
        <param name="control" hidden="true">
            <value>/sb/programs/analyste/software/smrtanalysis/common/references/Strobe_v1</value>
        </param>
        <param name="fetch" hidden="true" editable="false">
            <value>common/protocols/preprocessing/Fetch.1.xml</value>
        </param>
        <param name="filtering" editable="false">
            <value>common/protocols/filtering/SFilter.1.xml</value>
            <select multiple="true">
                <import extension="xml" contentType="text/directory">common/protocols/filtering</import>
            </select>
        </param>
        <param name="spikeinControl" hidden="true" editable="false">
            <value>common/protocols/control/SControl.1.xml</value>
        </param>
        <param name="mapping" editable="false">
            <value>common/protocols/mapping/BLASR.1.xml</value>
            <select multiple="true">
                <import extension="xml" contentType="text/directory">common/protocols/mapping</import>
            </select>
        </param>
        <param name="consensus" editable="false">
            <value>common/protocols/consensus/Quiver.1.xml</value>
            <select multiple="true">
                <import extension="xml" contentType="text/directory">common/protocols/consensus</import>
            </select>
        </param>
    </protocol>
    <moduleStage name="fetch" editable="true" />
    <moduleStage name="filtering" editable="true">
        <module label="SFilter v1" id="P_Filter" editableInJob="true">
            <description>This module filters reads based on a minimum read length, subread length and read quality.</description>
            <param name="minLength" label="Minimum Read Length">
                <title>The minimum read length. Shorter reads will be filtered and excluded from further analysis.</title>
                <value>50</value>
                <input type="text" size="3"/>
                <rule type="number" min="0.0" message="Value must be a positive integer"/>
            </param>
            <param name="minSubReadLength" label="Minimum Subread Length">
                <title>The minimum subread length. Shorter subreads will be filtered and excluded from further analysis.</title>
                <value>50</value>
                <input type="text" size="3"/>
                <rule type="number" min="0.0" message="Value must be a positive integer"/>
            </param>
            <param name="readScore" label="Minimum Read Quality">
                <title>The minimum read quality determines the quality cutoff. Reads with lower quality will be filtered and excluded from further analysis.</title>
                <value>0.75</value>
                <input type="text" size="3"/>
                <rule type="number" min="0.0" message="Value must be between 0 and 1" max="1.0"/>
            </param>
        </module>
        <module label="SFilter Reports v1" id="P_FilterReports" editableInJob="false"/>
    </moduleStage>
    <moduleStage name="spikeinControl" editable="true">
        <module label="SControl v1" id="P_Control" editableInJob="true">
            <param name="align_opts" hidden="true">
                <value>-x -bestn 1 --minAccuracy=0.75 --minLength=50 --useQuality</value>
            </param>
        </module>
        <module label="SControl Reports v1" id="P_ControlReports" editableInJob="false"/>
    </moduleStage>
    <moduleStage name="mapping" editable="true">
        <module label="BLASR v1" id="P_Mapping" editableInJob="true">
            <description>
BLASR maps reads to genomes by finding the highest scoring local alignment or set of local alignments between the read and the genome. The first set of alignments is found by querying an index of the reference genome, and then refining until only high scoring alignments are retained.  Additional pulse metrics are loaded into the resulting cmp.h5 file to enable downstream use of the Quiver algorithm.
    </description>
            <param name="maxHits" label="Maximum number of hits per read" hidden="true">
                <title>
        The maximum number of matches of each read to the reference
        sequence that will be evaluated. maxHits should be greater
        than the expected number of repeats if you want to spread hits
        out on the genome.
      </title>
                <value>10</value>
                <input type="text"/>
                <rule type="digits" message="Value must be an integer between 0 and 1000"/>
            </param>
            <param name="maxDivergence" label="Maximum divergence (%)">
                <title>The maximum allowed divergence of a read from the reference sequence.</title>
                <value>30</value>
                <input type="text"/>
                <rule type="digits" message="Value must be an integer between 0 and 100"/>
            </param>
            <param name="minAnchorSize" label="Minimum anchor size">
                <title>The minimum anchor size defines the length of the read that must match against the reference sequence.</title>
                <value>12</value>
                <input type="text"/>
                <rule type="digits" message="Value must be an integer between 8 and 30"/>
            </param>
            <param name="samBam" label="Write output as a BAM file">
                <value>True</value>
                <input type="checkbox"/>
            </param>
            <param name="gff2Bed" label="Write BED coverage file">
                <value>True</value>
                <input type="checkbox"/>
            </param>
            <param name="placeRepeatsRandomly" label="Place repeats randomly">
                <value>True</value>
                <input type="checkbox"/>
            </param>
            <param name="align_opts" hidden="true">
                <value>--seed=1 --minAccuracy=0.75 --minLength=50 --useQuality </value>
            </param>
            <param name="pulseMetrics" hidden="true">
                <value>DeletionQV,IPD,InsertionQV,PulseWidth,QualityValue,MergeQV,SubstitutionQV,DeletionTag</value>
            </param>
        </module>
        <module label="BLASR Reports v1" id="P_MappingReports" editableInJob="false"/>
    </moduleStage>
    <moduleStage name="consensus" editable="true">
        <module label="Quiver v1" id="P_GenomicConsensus" editableInJob="true">
            <description>Quiver identifies haploid  SNPs and indels by performing a local  realignment of reads using the full range of sequence quality metrics.</description>
            <param name="algorithm" label="Consensus algorithm">
                <value>quiver</value>
                <input value="plurality" type="radio"/>
                <input value="quiver" type="radio"/>
            </param>
            <param name="outputConsensus" label="Output consensus FASTA and FASTQ files">
                <title>Output consensus FASTA and FASTQ files</title>
                <value>True</value>
                <input type="checkbox"/>
            </param>
            <param name="makeVcf" label="Write SNPs/Variants as VCF file">
                <title>Write SNPs/Variants in VCF format</title>
                <value>True</value>
                <input type="checkbox"/>
            </param>
            <param name="makeBed" label="Write SNPs/Variants as BED file">
                <title>Write SNPs/Variants in BED format</title>
                <value>True</value>
                <input type="checkbox"/>
            </param>
            <param name="enableMapQVFilter" label="Use only unambiguously mapped reads">
                <title>Filter out reads with Map QV less than 10. Coverage in repeat regions shorter than the read length will be reduced.</title>
                <value>True</value>
                <input type="checkbox"/>
            </param>
        </module>
        <module label="Genomic Consensus Reports v1" id="P_ConsensusReports" editableInJob="false"/>
    </moduleStage>
    <fileName>RS_Resequencing.1.xml</fileName>
</smrtpipeSettings>
